---
import type { CollectionEntry } from 'astro:content';
import Card from "./Card.astro";

interface Props {
  items: CollectionEntry<'blog'>[] | CollectionEntry<'projects'>[];
  showDate?: boolean;
}

const { items, showDate } = Astro.props;
---

<div class="card-grid">
  {
    items
      .sort(function (a, b) {
        return (
          new Date(b.data.pubDate).getTime() -
          new Date(a.data.pubDate).getTime()
        );
      })
      .map((item) => (
        <div class="fade-in-up">
          <Card
            url={'link' in item.data ? item.data.link : `/blog/${item.id.replace('.md', '')}`}
            image={item.data.image}
            title={item.data.title}
            description={item.data.description}
            pubDate={showDate ? item.data.pubDate.toISOString() : undefined}
            technologies={'technologies' in item.data && Array.isArray(item.data.technologies) ? item.data.technologies as string[] : undefined}
          />
        </div>
      ))
  }
</div>

<script>
  import { initScrollReveal } from '../scripts/scroll-reveal';
  
  // Initialize on first load
  initScrollReveal();
  
  // Re-initialize after View Transitions navigation
  document.addEventListener('astro:page-load', () => {
    initScrollReveal();
  });
</script>

<style>
  .card-grid {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    align-items: center;
  }
</style>
